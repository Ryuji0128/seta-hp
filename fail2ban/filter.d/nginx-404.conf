# fail2ban filter for nginx 404 errors
# /etc/fail2ban/filter.d/nginx-404.conf にコピーして使用

[Definition]

# 404エラーを検出するパターン
# アクセスログ形式: IP - - [timestamp] "GET /path HTTP/1.1" 404 size
failregex = ^<HOST> .* "(GET|POST|HEAD|PUT|DELETE).*" 404 .*$

# 無視するパターン（正常なリクエスト）
ignoreregex = ^<HOST> .* "(GET|POST) /(favicon\.ico|robots\.txt|sitemap\.xml|_next/|static/).*"
